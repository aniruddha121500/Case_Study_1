---
title: 'Case Study #1'
author: "Aniruddha Mukherjee"
date: "3/16/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Setup

#### Libraries Used in this Case Study

Below are the libraries used for this case study.
```{r, echo = TRUE}
library(ggplot2)
```

#### Reading the Data

Below is a sample output of the data that we are given. Note that the column names have been added by us.
```{r, echo = TRUE}
cdi = read.table("CDI.txt", na.strings=".", header=FALSE,
col.names = c("ID", "County", "State", "Land_Area", "Total_Pop", "PercentPop18_24", "PercentPop65_",
              "Num_Active_Phy", "Num_Hosp_Beds", "Total_Serious_crimes", "Percent_HS",
              "Percent_Bachelors", "Percent_Poverty", "Percent_Unemployment", "Per_Capita_Income", 
              "Total_Personal_Income", "Geographic_region"))
head(cdi)
```

To verify that the data that we have read has the correct dimensions, they are displayed below. The data should have $440$ rows and $17$ columns.
```{r, echo = TRUE}
dim(cdi)
```

### Summary of Variables

A display of the summary statistics of some of the quantitative variables are shown below. Along with the summary statistcs, a histogram and an appropriate scatter plot for a few variables are also shown below. This section aims to get the reader a better understanding of the variables that are present in this report. 

The summary statistics of the percent of the population that is aged $18$ to $24$ is displayed below.
```{r, echo = TRUE}
cdi.PercentPop18_24 = summary(cdi$PercentPop18_24)
cdi.PercentPop18_24
```



The summary statistics of the percent of the population that is aged $65$ or older is displayed below.
```{r, echo = TRUE}
cdi.PercentPop65_ = summary(cdi$PercentPop65_)
cdi.PercentPop65_
```



The summary statistic of the number of active nonfederal physicians during $1990$ is shown below is displayed below.
```{r, echo = TRUE}
cdi.Num_Active_Phy = summary(cdi$Num_Active_Phy)
cdi.Num_Active_Phy
```



A histogram of the number of active nonfederal physicians during $1990$ in each county is shown below.
```{r, echo = TRUE}
cdi.id_phy = as.data.frame(cdi[c("ID", "Num_Active_Phy")])
barplot(height = cdi.id_phy$Num_Active_Phy, names = cdi.id_phy$ID, xlab = "ID of Counties",
        ylab = "Number of Physicians", main = "Number of Physicians by County", 
        col = c("red", "green", "blue", "yellow"), border = c("red", "green", "blue", "yellow"))
```

Based on the histogram above, there seems to be a few outliers in the number of Physicians. To explore this idea, a scatter plot is shown below.



A scatter plot of the number of active nonfederal physicians during $1990$ in each county is shown below.
```{r, echo = TRUE}
ggplot(cdi.id_phy, aes(x = ID, y = Num_Active_Phy)) + 
  geom_point( size = 1, shape = 23, color = "red")
```



Based on the scatter plot above, two conties seem to have a much higher number of physicians than all other counties.
The two counties with a higher number of physicians are shown below.
```{r, echo = TRUE}
cdi.df <- as.data.frame(cdi)
head(cdi.df[ order(-cdi.df$Num_Active_Phy), ], 2)
```

As seen in the output above, the two counties with the greatest number of physicians in 1990 are **Los Angeles** county and **Cook** county.



The summary statistic of the number of beds, cribs and bassinets during $1990$ is shown below is displayed below.
```{r, echo = TRUE}
cdi.Num_Hosp_Beds = summary(cdi$Num_Hosp_Beds)
cdi.Num_Hosp_Beds
```



A histogram of the number of beds, cribs and bassinets during $1990$ in each county is shown below.
```{r, echo = TRUE}
cdi.id_hos = as.data.frame(cdi[c("ID", "Num_Hosp_Beds")])
barplot(height = cdi.id_hos$Num_Hosp_Beds, names = cdi.id_hos$ID, xlab = "ID of Counties",
        ylab = "Number of Hospital Beds", main = "Number of Hospital Beds by County", 
        col = c("red", "green", "blue", "yellow"), border = c("red", "green", "blue", "yellow"))
```



Based on the histogram above, there seems to be a few outliers in the number of hospital beds. To explore this idea, a scatter plot is shown below.
```{r, echo = TRUE}
ggplot(cdi.id_hos, aes(x = ID, y = Num_Hosp_Beds)) + 
  geom_point( size = 1, shape = 23, color = "red")
```



Based on the scatter plot above, three conties seem to have a much higher number of hospital beds than all other counties.
The three counties with a higher number of physicians are shown below.
```{r, echo = TRUE}
head(cdi.df[ order(-cdi.df$Num_Hosp_Beds), ], 3)
```

The three counties with the most number of hospital beds are **Los Angeles** county, **Cook** county and **Harris** county. 



The summary statistic of the total number of serious crimes in 1990 as reported by law enforcement agencies is displayed below.
```{r, echo = TRUE}
cdi.Total_Serious_crimes = summary(cdi$Total_Serious_crimes)
cdi.Total_Serious_crimes
```



The summary statistic of the percent of the population that completed $12$ or more years of education (high school education) is displayed below.
```{r, echo = TRUE}
cdi.Percent_HS = summary(cdi$Percent_HS)
cdi.Percent_HS
```



The summary statistic of the percent of the adult population with bachelor's degrees is displayed below.
```{r, echo = TRUE}
cdi.Percent_Bachelors = summary(cdi$Percent_Bachelors)
cdi.Percent_Bachelors
```



The summary statistic of the percent of CDI population with income below poverty level is displayed below.
```{r, echo = TRUE}
cdi.Percent_Poverty = summary(cdi$Percent_Poverty)
cdi.Percent_Poverty
```



The summary statistic of the per capita income of 1990 CDI population (in U.S. dollars) is displayed below.
```{r, echo = TRUE}
cdi.Per_Capita_Income = summary(cdi$Per_Capita_Income)
cdi.Per_Capita_Income
```



The summary statistic of the total personal income of 1990 CDI population (in millions of U.S. dollars) is displayed below.
```{r, echo = TRUE}
cdi.Total_Personal_Income = summary(cdi$Total_Personal_Income)
cdi.Total_Personal_Income
```



The summary statistics of the percent of 1990 CDI labor force that is unemployed is displayed below.
```{r, echo = TRUE}
cdi.Percent_Unemployment = summary(cdi$Percent_Unemployment)
cdi.Percent_Unemployment
```



Histogram of Geographic Region is shown below.
```{r, echo = TRUE}
ggplot(cdi, aes(x = Geographic_region, fill = Geographic_region)) +
  geom_bar(position = "identity", bins = 4, fill = c("red", "green", "blue", "yellow")) +
  labs(title = "Distribution of Geographic region", x = "Geographic Region") + 
  scale_x_discrete(limits=c("NE", "NC", "S", "W")) + 
  theme_minimal() + ggeasy::easy_center_title()
```



<!-- Include Analysis Later -->
```{r, echo = TRUE}
# # Linear Regression with Suggested Variables ?
# cdimodel0 = lm(Num_Active_Phy ~ Total_Pop + Land_Area + Total_Personal_Income, cdi)
# 
# cdimodel0.summary = summary(cdimodel0)
# 
# print(cdimodel0.summary) # Al variables seem significant especially Total_Personal_Income

# Checking for model assumptions

  # Check for Linearity
  #

  # Check for Homoscdedacity
  # residual plot

  # Check for Independence

  # Check for Normality


# Linear Regression
# cdimodel1 = lm(Num_Active_Phy ~ Total_Serious_crimes + Per_Capita_Income + Num_Hosp_Beds, cdi)

# cdimodel1.summary = summary(cdimodel1)

# print(cdimodel1.summary) # Total_Serious_crimes p-val (0.0636) > 0.05

# cdimodel2 = lm(Num_Active_Phy ~ Per_Capita_Income + Num_Hosp_Beds, cdi)

# cdimodel2.summary = summary(cdimodel2)

# print(cdimodel2.summary)

# anova_mod1_mod2 = anova(cdimodel1, cdimodel2)

# print(anova_mod1_mod2) # Fail to reject null, proceed with cdimodel2

# Analysis with
```




































